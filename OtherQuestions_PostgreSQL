该文件中将讲述 FILTER, ARRAY_AGG 两个语句

来看一个表 Runners：
Runners:
-------------------------------------------------------
|    name   |   weight   |    country    |    time    |
-------------------------------------------------------
|    andy   |     50     |      UK       |    101     |
-------------------------------------------------------
|    bob    |     100    |      UK       |    103     |
-------------------------------------------------------
|   cedric  |     50     |    France     |    104     |
-------------------------------------------------------
|    dave   |     70     |    Germany    |    104     |
-------------------------------------------------------
|    eric   |     50     |    France     |    108     |
-------------------------------------------------------

创建表：
DROP TABLE IF EXISTS Runners;
CREATE TABLE Runners
  (name VARCHAR(20), weight INT, country VARCHAR(20), time INT);
INSERT INTO Runners
VALUES 
  ('andy', 50, 'UK', 101),
  ('bob', 100, 'UK', 103),
  ('cedric', 50, 'France', 104),
  ('dave', 70, 'Germany', 104),
  ('eric', 70, 'France', 108);

问题：如何从Runners表中选出 每个国家 选手们的 平均时间，然后根据 每个选手的平均时间，挑选出 体重小于90kg 的选手 作为 'light_runners_time'列。
说明： 对于 UK, 平均时间为 (101 + 103) / 2 = 102，记为 'avg_time'列。 由于'bob'超过 90kg，所以 'light_runners_time'列中，先去掉 'bob'，然后求平均为： (101) / 1 = 101。

-- Expected Output：
-----------------------------------------------
|    country    | avg_time |light_runners_time|
-----------------------------------------------
|      UK       |   102    |       101        |
-----------------------------------------------
|    France     |   106    |       106        |
-----------------------------------------------
|    Germany    |   104    |       104        |
-----------------------------------------------


-- 答案：
SELECT country,
    AVG(time) as avg_time,
    AVG(time) FILTER (WHERE weight < 90) AS light_runners_time
FROM Runners
GROUP BY country;


=======================================================================================================
ARRAY_AGG
这条语句 并不属于 window function，但比较有趣，所以想讲讲。
ARRAY_AGG 可以帮我们 将若干个 数据 转换成一个 数组（array）。

例如，对于Runners表：
Runners:
-------------------------------------------------------
|    name   |   weight   |    country    |    time    |
-------------------------------------------------------
|    andy   |     50     |      UK       |    101     |
-------------------------------------------------------
|    bob    |     100    |      UK       |    103     |
-------------------------------------------------------
|   cedric  |     50     |    France     |    104     |
-------------------------------------------------------
|    dave   |     70     |    Germany    |    104     |
-------------------------------------------------------
|    eric   |     50     |    France     |    108     |
-------------------------------------------------------

我们想将所有的 'time' 列的数据变成一个 数组的形式，该怎么做？

-- Expected Output：
------------------------------
|         array_agg          |
------------------------------
| {101, 103, 104, 104, 108}  |
------------------------------


-- 答案：
SELECT ARRAY_AGG(time)
FROM Runners;








